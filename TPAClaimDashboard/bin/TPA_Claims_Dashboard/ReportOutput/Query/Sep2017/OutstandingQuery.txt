 select  (SELECT TPA_NM FROM TTPA where TPA_ID=X.tpa_id and TXN_XPIRY_DT='12/31/9999' and PRODUCTION_IN='Y' and INIT_RECON_STAT_CD='CMPL'), X.LOB_CD, X.Description, X.INDYearToDate, X.INDPiorYeartoDate, (X.INDYearToDate - X.INDPiorYeartoDate), X.MedYearToDate, X.MedPiorYeartoDate, (X.MedYearToDate -X.MedPiorYeartoDate), X.ExpYearToDate, X.ExpPiorYeartoDate, (X.ExpYearToDate-X.ExpPiorYeartoDate) from (select  a.TPA_ID, a.LOB_CD,  (SELECT MAJOR_CLASS_DS FROM TMAJOR_CLASS WHERE MAJOR_CLASS_CD = a.MAJOR_CLASS_CD and LOB_CD = a.lob_cd) as Description, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2017' and b.FINCL_VALTN_XPR_DT>'07/31/2017') then (b.IN_BI_INCURRED_AM- b.IN_BI_PTD_AM) else 0 end ) as INDYearToDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2016' and b.FINCL_VALTN_XPR_DT>'07/31/2016') then (b.IN_BI_INCURRED_AM- b.IN_BI_PTD_AM) else 0 end ) as INDPiorYeartoDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2017' and b.FINCL_VALTN_XPR_DT>'07/31/2017') then (b.MD_PD_INCURRED_AM- b.MD_PD_PTD_AM) else 0 end )as MedYearToDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2016' and b.FINCL_VALTN_XPR_DT>'07/31/2016') then (b.MD_PD_INCURRED_AM- b.MD_PD_PTD_AM) else 0 end ) as MedPiorYeartoDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2017' and b.FINCL_VALTN_XPR_DT>'07/31/2017') then (b.XPNS_INCURRED_AM - b.XPNS_PTD_AM) else 0 end ) as ExpYearToDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2016' and b.FINCL_VALTN_XPR_DT>'07/31/2016') then (b.XPNS_INCURRED_AM - b.XPNS_PTD_AM) else 0 end ) as ExpPiorYeartoDate FROM TCLM_SYMBOL a, TCLM_FINCL b where  a.TPA_ID in ( 006,010,043 ) and a.VALUATION_XPIRY_DT='12/31/9999'  and a.TPA_ID=b.TPA_ID and a.CLIENT_CD=b.CLIENT_CD and a.BRANCH_NO=b.BRANCH_NO and a.CASE_NO=b.CASE_NO and a.CASE_SYMBOL_NO=b.CASE_SYMBOL_NO and a.SYMBOL_CREATE_DT=b.SYMBOL_CREATE_DT  and b.FINCL_VALTN_EFF_DT>='01/31/2016' and b.FINCL_XPIR_DT='12/31/9999' group by a.TPA_ID, a.LOB_CD,  a.MAJOR_CLASS_CD union select  a.TPA_ID, a.LOB_CD,  'ZSummary' as Description, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2017' and b.FINCL_VALTN_XPR_DT>'07/31/2017') then (b.IN_BI_INCURRED_AM- b.IN_BI_PTD_AM) else 0 end ) as INDYearToDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2016' and b.FINCL_VALTN_XPR_DT>'07/31/2016') then (b.IN_BI_INCURRED_AM- b.IN_BI_PTD_AM) else 0 end ) as INDPiorYeartoDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2017' and b.FINCL_VALTN_XPR_DT>'07/31/2017') then (b.MD_PD_INCURRED_AM- b.MD_PD_PTD_AM) else 0 end ) as MedYearToDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2016' and b.FINCL_VALTN_XPR_DT>'07/31/2016') then (b.MD_PD_INCURRED_AM- b.MD_PD_PTD_AM) else 0 end ) as MedPiorYeartoDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2017' and b.FINCL_VALTN_XPR_DT>'07/31/2017') then (b.XPNS_INCURRED_AM - b.XPNS_PTD_AM) else 0 end ) as ExpYearToDate, sum(case when (b.FINCL_VALTN_EFF_DT<='07/31/2016' and b.FINCL_VALTN_XPR_DT>'07/31/2016') then (b.XPNS_INCURRED_AM - b.XPNS_PTD_AM) else 0 end ) as ExpPiorYeartoDate FROM TCLM_SYMBOL a, TCLM_FINCL b where  a.TPA_ID in ( 006,010,043 ) and a.VALUATION_XPIRY_DT='12/31/9999'  and a.TPA_ID=b.TPA_ID and a.CLIENT_CD=b.CLIENT_CD and a.BRANCH_NO=b.BRANCH_NO and a.CASE_NO=b.CASE_NO and a.CASE_SYMBOL_NO=b.CASE_SYMBOL_NO and a.SYMBOL_CREATE_DT=b.SYMBOL_CREATE_DT  and b.FINCL_VALTN_EFF_DT>='01/31/2016' and b.FINCL_XPIR_DT='12/31/9999' group by a.TPA_ID, a.LOB_CD) X where X.INDYearToDate> 0 or X.INDPiorYeartoDate>0 or X.MedYearToDate >0 or X.MedPiorYeartoDate>0 or X.ExpYearToDate >0 or X.ExpPiorYeartoDate>0 order by X.tpa_id, X.lob_cd with ur  