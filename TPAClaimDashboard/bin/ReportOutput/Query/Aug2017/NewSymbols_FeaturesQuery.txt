SELECT * FROM (   SELECT    (SELECT TPA_NM FROM TTPA where TPA_ID=t.tpa_id and TXN_XPIRY_DT='12/31/9999' and PRODUCTION_IN='Y' and INIT_RECON_STAT_CD='CMPL'),   t.LOB_CD,   (SELECT MAJOR_CLASS_DS FROM TMAJOR_CLASS WHERE MAJOR_CLASS_CD = t.MAJOR_CLASS_CD and LOB_CD = t.lob_cd),   t.Year_to_Date,   t.Prior_Year_to_Date,   (t.Year_to_Date-t.Prior_Year_to_Date) as Year_to_Date_Change,   t.Current_Month,   t.Prior_Year_Current_Month    FROM    (      SELECT       a.TPA_ID,      a.LOB_CD,      a.MAJOR_CLASS_cd,      sum(case when a.ORGNL_VALTN_EFF_DT >= (Date(YEAR('2017-08-31')||'-'|| '01' || '-' ||'31')) then 1 else 0 end) as Year_to_Date,         sum(case when a.ORGNL_VALTN_EFF_DT >= (Date((YEAR('2017-08-31') -1) ||'-'|| '01' || '-' ||'31')) then 1 else 0 end ) as Prior_Year_to_Date ,      sum(case when a.ORGNL_VALTN_EFF_DT = '2017-08-31' then 1 else 0 end ) as Current_Month,      sum      (         case when a.ORGNL_VALTN_EFF_DT = (Date((YEAR('2017-08-31') -1) ||'-'|| MONTH('2017-08-31') || '-' || DAY('2017-08-31'))) then 1 else 0 end      )      as Prior_Year_Current_Month       FROM TCLM_SYMBOL a       where a.TPA_ID in ( 006,010 )       and a.VALUATION_XPIRY_DT = '12/31/9999'       GROUP by a.TPA_ID,a.LOB_CD,a.MAJOR_CLASS_cd    )    t    where    (      t.Year_to_Date +t.Prior_Year_to_Date+t.Current_Month +t.Prior_Year_Current_Month   )   >0    union    SELECT    (SELECT TPA_NM FROM TTPA where TPA_ID=tt.tpa_id and TXN_XPIRY_DT='12/31/9999' and PRODUCTION_IN='Y' and 	INIT_RECON_STAT_CD='CMPL'),   tt.LOB_CD,   'zSummary',   tt.Year_to_Date,   tt.Prior_Year_to_Date,   (tt.Year_to_Date-tt.Prior_Year_to_Date) as Year_to_Date_Change,   tt.Current_Month,   tt.Prior_Year_Current_Month    FROM    (      SELECT       a.TPA_ID,      a.LOB_CD,      sum(case when a.ORGNL_VALTN_EFF_DT >= (Date(YEAR('2017-08-31')||'-'|| '01' || '-' ||'31')) then 1 else 0 end) as Year_to_Date,         sum(case when a.ORGNL_VALTN_EFF_DT >= (Date((YEAR('2017-08-31') -1) ||'-'|| '01' || '-' ||'31')) then 1 else 0 end ) as Prior_Year_to_Date ,      sum(case when a.ORGNL_VALTN_EFF_DT = '2017-08-31' then 1 else 0 end ) as Current_Month,      sum      (         case when a.ORGNL_VALTN_EFF_DT = (Date((YEAR('2017-08-31') -1) ||'-'|| MONTH('2017-08-31') || '-' || DAY('2017-08-31'))) then 1 else 0 end       )      as Prior_Year_Current_Month       FROM TCLM_SYMBOL a       where a.TPA_ID in ( 006,010 )       and a.VALUATION_XPIRY_DT = '12/31/9999'       GROUP by a.TPA_ID,a.LOB_CD    )    tt    where    (      tt.Year_to_Date +tt.Prior_Year_to_Date+tt.Current_Month +tt.Prior_Year_Current_Month   )   >0 ) X order by X.TPA_NM , X.LOB_CD, X.MAJOR_CLASS_DS  for read only with ur